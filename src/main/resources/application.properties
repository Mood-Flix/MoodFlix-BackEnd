# =========================
# 애플리케이션 설정
# =========================
spring.application.name=MoodFlix

# =========================
# 데이터소스 (MySQL)
# 환경 변수로 DB 연결 정보 설정 (URL, 사용자 이름, 비밀번호)
# =========================
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=10000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1700000
spring.datasource.hikari.leak-detection-threshold=20000
spring.datasource.hikari.pool-name=app-main-pool

# =========================
# TMDB API
# TMDB API 키를 환경 변수로 설정
# =========================
tmdb.api.key=${TMDB_API_KEY:}

# =========================
# JWT 설정
# JWT 비밀키와 토큰 만료 시간(액세스/리프레시)을 환경 변수로 설정
# =========================
jwt.secret.key=${JWT_SECRET:}
jwt.expiration.ms=${JWT_EXPIRATION_MS:36000000}
jwt.refresh-expiration-ms=${JWT_REFRESH_EXPIRATION_MS:604800000}

# =========================
# JPA 설정
# 배포 환경에서는 ddl-auto=validate 사용 권장, Flyway로 마이그레이션 관리
# =========================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# =========================
# Actuator 설정
# 헬스체크 엔드포인트(/actuator/health)만 노출
# =========================
management.endpoints.web.exposure.include=health

# =========================
# Kakao OAuth 설정
# Kakao 클라이언트 ID와 리다이렉트 URI를 환경 변수로 설정
# =========================
kakao.client-id=${KAKAO_CLIENT_ID:}
kakao.redirect-uri=${KAKAO_REDIRECT_URI:http://localhost:8080/auth/login/kakao}

# =========================
# WebFlux Codec 설정
# JSON 데이터 처리 시 메모리 제한을 10MB로 설정 (기본 256KB에서 확장)
# =========================
spring.codec.max-in-memory-size=10MB

# =========================
# 모델 서버 설정
# 배포 환경: http://43.203.134.10:8001, 로컬 환경: http://localhost:8001
# 타임아웃 설정: 연결/읽기 타임아웃 및 전체 타임아웃
# =========================
moodflix.model.base-url=${MODEL_BASE_URL}
moodflix.model.timeout-ms=${MODEL_TIMEOUT_MS:30000}
moodflix.model.connect-timeout-ms=${MODEL_CONNECT_TIMEOUT_MS:2000}
moodflix.model.read-timeout-ms=${MODEL_READ_TIMEOUT_MS:3000}

# =========================
# Elasticsearch 설정
# HTTPS 사용 권장, 인증서 검증 비활성화는 보안 취약점 주의
# =========================
spring.elasticsearch.uris=http://ec2-13-209-3-38.ap-northeast-2.compute.amazonaws.com:9200
spring.elasticsearch.username=elastic
spring.elasticsearch.password=${SPRING_ELASTICSEARCH_PASSWORD}
spring.elasticsearch.ssl.verification-mode=none

# =========================
# 로깅 설정
# Spring Security, 애플리케이션, 웹 관련 디버그 로깅 활성화
# =========================
logging.level.org.springframework.security=DEBUG
logging.level.com.duck.moodflix=DEBUG
logging.level.org.springframework.web=DEBUG